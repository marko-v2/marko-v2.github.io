<!doctype html> <html lang="en"><head><meta http-equiv="Content-Type" content="text/html" charset="UTF-8"><meta name="robots" content="noindex"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><title>JavaScript API | Marko</title><link rel="alternate" type="application/rss+xml" title="RSS" href="/rss.xml"><meta name="description"><link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="manifest" href="/manifest.json"><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta name="viewport" content="initial-scale=1,user-scalable=no,maximum-scale=1,width=device-width"><link rel="stylesheet" href="/static/docs-page-c76dd320.css">
<link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css"></head><body><header id="header" data-widget="/src/components/app-header"><div class="container"><div id="logo"><a href="/"><img src="/images/logo-header.png" alt="Marko"></a></div><nav role="navigation" id="nav" class="mobile-hidden"><ul class="main-navigation"><li><a href="/docs/" class="active">Docs</a></li><li><a href="/community/">Community</a></li><li><a href="/blog/">Blog</a></li><li><a href="/github/">Github</a></li><li class="nav-search"><i class="fa fa-search" data-w-onclick="handleToggleSearchClick|header"></i><form action="https://google.com/search" method="get" class="search-form"><input type="hidden" name="as_sitesearch" value="markojs.com"><input type="text" name="q" results="0" placeholder class="search-input"></form></li></ul></nav><div style="clear: both"></div></div></header><div class="container"><aside class="docs-nav"><section><h1>Marko</h1><ul><li><a href="/docs/">Overview</a></li><li><a href="/docs/marko/get-started/">Get Started</a></li><li><a href="/docs/marko/javascript-api/" class="active">JavaScript API</a></li><li><a href="/docs/marko/language-guide/">Language Guide</a></li><li><a href="/docs/marko/custom-taglibs/">Custom Taglibs</a></li><li><a href="/docs/marko/compiler/">Compiler</a></li><li><a href="/docs/marko/faq/">FAQ</a></li><li><a href="/docs/marko/additional-resources/">Additional Resources</a></li></ul><div class="footer"><a class="try-online" href="http://markojs.com/try-online/" target="_blank">Try Online! <img width="16" height="16" src="/static/new-window-81a33b35.svg"></a></div></section><section><h1>Marko Widgets</h1><ul><li><a href="/docs/marko-widgets/">Overview</a></li><li><a href="/docs/marko-widgets/get-started/">Get Started</a></li><li><a href="/docs/marko-widgets/component-lifecycle/">Component Lifecycle</a></li><li><a href="/docs/marko-widgets/javascript-api/">JavaScript API</a></li><li><a href="/docs/marko-widgets/faq/">FAQ</a></li><li><a href="/docs/marko-widgets/additional-resources/">Additional Resources</a></li></ul><div class="footer"><a class="try-online" href="http://markojs.com/marko-widgets/try-online/" target="_blank">Try Online! <img width="16" height="16" src="/static/new-window-81a33b35.svg"></a></div></section></aside><main><h1 class="page-title">JavaScript API <span class="subtitle">// Marko</span></h1><p class="toc"><strong>Table of Contents</strong><ul class="toc-level0"><li><a href="#require&#39marko&#39">require(&#39;marko&#39;)</a><ul class="toc-level1"><li><a href="#methods">Methods</a><ul class="toc-level2"><li><a href="#loadtemplatepath-templatesrc-options--template">load(templatePath[, templateSrc][, options]) : Template</a></li><li><a href="#createwriterstream--asyncwriter">createWriter([stream]) : AsyncWriter</a></li><li><a href="#rendertemplatepath-templatedata-streamwritable">render(templatePath, templateData, stream.Writable)</a></li><li><a href="#rendertemplatepath-templatedata-callback">render(templatePath, templateData, callback)</a></li><li><a href="#streamtemplatepath-templatedata--streamreadable">stream(templatePath, templateData) : stream.Readable</a></li></ul></li><li><a href="#properties">Properties</a><ul class="toc-level2"><li><a href="#helpers">helpers</a></li><li><a href="#template">Template</a></li></ul></li></ul></li><li><a href="#template-1">Template</a><ul class="toc-level1"><li><a href="#methods-1">Methods</a><ul class="toc-level2"><li><a href="#rendersynctemplatedata--string">renderSync(templateData) : String</a></li><li><a href="#rendertemplatedata-streamwritable">render(templateData, stream.Writable)</a></li><li><a href="#rendertemplatedata-asyncwriter">render(templateData, AsyncWriter)</a></li><li><a href="#rendertemplatedata-callback">render(templateData, callback)</a></li><li><a href="#streamtemplatedata--streamreadable">stream(templateData) : stream.Readable</a></li></ul></li></ul></li><li><a href="#require&#39markocompiler&#39">require(&#39;marko/compiler&#39;)</a><ul class="toc-level1"><li><a href="#methods-2">Methods</a><ul class="toc-level2"><li><a href="#createcompilerpath-options--templatecompiler">createCompiler(path, options) : TemplateCompiler</a></li><li><a href="#compilesrc-path-options-callback">compile(src, path, options, callback)</a></li><li><a href="#compilefilepath-options-callback">compileFile(path, options, callback)</a></li><li><a href="#getlastmodifiedpath-options-callback">getLastModified(path, options, callback)</a></li><li><a href="#clearcaches">clearCaches()</a></li></ul></li><li><a href="#properties-1">Properties</a><ul class="toc-level2"><li><a href="#defaultoptions">defaultOptions</a></li></ul></li></ul></li></ul></p>
<h2 id="require&#39marko&#39"><a name="require&#39marko&#39" class="anchor" href="#require&#39marko&#39"><span class="header-link"></span></a>require(&#39;marko&#39;)</h2><h3 id="methods"><a name="methods" class="anchor" href="#methods"><span class="header-link"></span></a>Methods</h3><h4 id="loadtemplatepath-templatesrc-options--template"><a name="loadtemplatepath-templatesrc-options--template" class="anchor" href="#loadtemplatepath-templatesrc-options--template"><span class="header-link"></span></a>load(templatePath[, templateSrc][, options]) : Template</h4><p>Loads a template instance for the given template path.
Both <code>templateSrc</code> and <code>options</code> are optional.</p>
<p>Template loading is supported in the browser and on
the server but the behavior differs slightly.</p>
<p><strong>On the server,</strong>
if <code>templateSrc</code> is not provided then <code>templatePath</code> is expected
to be the path to a Marko template file. If <code>templateSrc</code>
is provided then it is expected to be a <code>String</code> and its value
will be the raw template. The <code>templatePath</code>
argument is only used for reporting error stack traces if
<code>templateSrc</code> is provided.</p>
<p><strong>In the browser,</strong>
<code>templatePath</code> is expected to path to be the module name
of the compiled template and the module will be loaded
via <code>require(templatePath)</code>. The <code>templateSrc</code> argument
is ignored if the <code>load</code> function is called in the browser.</p>
<p>If <code>options</code> is provided then it is expected to be the last argument
and should be an <code>Object</code>.</p>
<p>Example usage for browser and server:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> templatePath = <span class="hljs-built_in">require</span>.resolve(<span class="hljs-string">'./template.marko'</span>);
<span class="hljs-keyword">var</span> template = <span class="hljs-built_in">require</span>(<span class="hljs-string">'marko'</span>).load(templatePath);
template.render({ name: <span class="hljs-string">'Frank'</span> }, process.stdout);
</code></pre>
<p>Example <strong>server-side</strong> template loading with <code>writeToDisk: false</code> option:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> templatePath = <span class="hljs-string">'./sample.marko'</span>;
<span class="hljs-keyword">var</span> template = <span class="hljs-built_in">require</span>(<span class="hljs-string">'marko'</span>).load(templatePath, {writeToDisk: <span class="hljs-literal">false</span>});
template.render({ name: <span class="hljs-string">'Frank'</span> }, process.stdout);
</code></pre>
<p>Example <strong>server-side</strong> template compilation from string:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> templatePath = <span class="hljs-string">'sample.marko'</span>;
<span class="hljs-keyword">var</span> templateSrc = <span class="hljs-string">'Hello $!{data.name}'</span>;
<span class="hljs-keyword">var</span> template = <span class="hljs-built_in">require</span>(<span class="hljs-string">'marko'</span>).load(templatePath, templateSrc);
template.render({ name: <span class="hljs-string">'Frank'</span> }, process.stdout);
</code></pre>
<p>Supported <code>options</code>:</p>
<ul>
<li><p><code>buffer</code> (<code>Boolean</code>) - If <code>true</code> (default) then rendered output will be
buffered until <code>out.flush()</code> is called or until rendering is completed.
Otherwise, the output will be written to the underlying stream as soon as
it is produced.</p>
</li>
<li><p><code>writeToDisk</code> (<code>Boolean</code>) - This option is only applicable to server-side
template loading. If <code>true</code> then compiled template will be written to disk.
If <code>false</code>, template will be compiled and loaded but the compiled source
will not be written to disk.</p>
</li>
</ul>
<h4 id="createwriterstream--asyncwriter"><a name="createwriterstream--asyncwriter" class="anchor" href="#createwriterstream--asyncwriter"><span class="header-link"></span></a>createWriter([stream]) : AsyncWriter</h4><p>Creates an instance of an <a href="https://github.com/marko-js/async-writer">AsyncWriter</a> instance that can be used to support asynchronous rendering.</p>
<p>Example usage:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> out = <span class="hljs-built_in">require</span>(<span class="hljs-string">'async-writer'</span>).create(process.stdout);
out.write(<span class="hljs-string">'Hello'</span>);

<span class="hljs-keyword">var</span> asyncOut = out.beginAsync();
setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    asyncOut.write(<span class="hljs-string">'World'</span>)
    asyncOut.end();
}, <span class="hljs-number">100</span>);

<span class="hljs-built_in">require</span>(<span class="hljs-string">'./template.marko'</span>).render({}, out);
</code></pre>
<h4 id="rendertemplatepath-templatedata-streamwritable"><a name="rendertemplatepath-templatedata-streamwritable" class="anchor" href="#rendertemplatepath-templatedata-streamwritable"><span class="header-link"></span></a>render(templatePath, templateData, stream.Writable)</h4><p>Deprecated. Do not use.</p>
<h4 id="rendertemplatepath-templatedata-callback"><a name="rendertemplatepath-templatedata-callback" class="anchor" href="#rendertemplatepath-templatedata-callback"><span class="header-link"></span></a>render(templatePath, templateData, callback)</h4><p>Deprecated. Do not use.</p>
<h4 id="streamtemplatepath-templatedata--streamreadable"><a name="streamtemplatepath-templatedata--streamreadable" class="anchor" href="#streamtemplatepath-templatedata--streamreadable"><span class="header-link"></span></a>stream(templatePath, templateData) : stream.Readable</h4><p>Deprecated. Do not use.</p>
<h3 id="properties"><a name="properties" class="anchor" href="#properties"><span class="header-link"></span></a>Properties</h3><h4 id="helpers"><a name="helpers" class="anchor" href="#helpers"><span class="header-link"></span></a>helpers</h4><p>Global helpers passed to all templates. Available in compiled templates as the <code>__helpers</code> variable. It is not recommended to use this property to introduce global helpers (globals are evil).</p>
<h4 id="template"><a name="template" class="anchor" href="#template"><span class="header-link"></span></a>Template</h4><p>The <code>Template</code> type.</p>
<h2 id="template-1"><a name="template-1" class="anchor" href="#template-1"><span class="header-link"></span></a>Template</h2><h3 id="methods-1"><a name="methods-1" class="anchor" href="#methods-1"><span class="header-link"></span></a>Methods</h3><h4 id="rendersynctemplatedata--string"><a name="rendersynctemplatedata--string" class="anchor" href="#rendersynctemplatedata--string"><span class="header-link"></span></a>renderSync(templateData) : String</h4><p>Synchronously renders a template to a <code>String</code>.</p>
<p><em>NOTE: If <code>out.beginAsync()</code> is called during synchronous rendering an error will be thrown.</em></p>
<p>Example usage:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> template = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./template.marko'</span>);
<span class="hljs-keyword">var</span> html = template.renderSync({ name: <span class="hljs-string">'Frank'</span> });
<span class="hljs-built_in">console</span>.log(html);
</code></pre>
<h4 id="rendertemplatedata-streamwritable"><a name="rendertemplatedata-streamwritable" class="anchor" href="#rendertemplatedata-streamwritable"><span class="header-link"></span></a>render(templateData, stream.Writable)</h4><p>Renders a template to a writable stream.</p>
<p>Example usage:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> template = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./template.marko'</span>);
template.render({ name: <span class="hljs-string">'Frank'</span> }, process.stdout);
</code></pre>
<h4 id="rendertemplatedata-asyncwriter"><a name="rendertemplatedata-asyncwriter" class="anchor" href="#rendertemplatedata-asyncwriter"><span class="header-link"></span></a>render(templateData, AsyncWriter)</h4><p>Renders a template to an <a href="https://github.com/marko-js/async-writer">AsyncWriter</a> instance that wraps an underlying stream.</p>
<p>Example usage:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> template = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./template.marko'</span>);
<span class="hljs-keyword">var</span> out = <span class="hljs-built_in">require</span>(<span class="hljs-string">'marko'</span>).createWriter(process.stdout);
template.render({ name: <span class="hljs-string">'Frank'</span> }, out);
</code></pre>
<h4 id="rendertemplatedata-callback"><a name="rendertemplatedata-callback" class="anchor" href="#rendertemplatedata-callback"><span class="header-link"></span></a>render(templateData, callback)</h4><p>Asynchronously renders a template and provides the output to the provided callback function.</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> template = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./template.marko'</span>);
template.render({ name: <span class="hljs-string">'Frank'</span> }, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">err, html, out</span>) </span>{
    <span class="hljs-keyword">if</span> (err) {
        <span class="hljs-comment">// Handel the error...</span>
    }

    <span class="hljs-built_in">console</span>.log(html);
});
</code></pre>
<p><em>NOTE: The <code>out</code> argument will rarely be used, but it will be a reference to the <a href="https://github.com/marko-js/async-writer">AsyncWriter</a> instance that was created to facilitate rendering of the template.</em></p>
<h4 id="streamtemplatedata--streamreadable"><a name="streamtemplatedata--streamreadable" class="anchor" href="#streamtemplatedata--streamreadable"><span class="header-link"></span></a>stream(templateData) : stream.Readable</h4><p>Returns a readable stream that can be used to read the output of rendering a template.</p>
<p>Example usage:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> template = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./template.marko'</span>);
template.stream({ name: <span class="hljs-string">'Frank'</span> }).pipe(process.stdout);
</code></pre>
<h2 id="require&#39markocompiler&#39"><a name="require&#39markocompiler&#39" class="anchor" href="#require&#39markocompiler&#39"><span class="header-link"></span></a>require(&#39;marko/compiler&#39;)</h2><h3 id="methods-2"><a name="methods-2" class="anchor" href="#methods-2"><span class="header-link"></span></a>Methods</h3><h4 id="createcompilerpath-options--templatecompiler"><a name="createcompilerpath-options--templatecompiler" class="anchor" href="#createcompilerpath-options--templatecompiler"><span class="header-link"></span></a>createCompiler(path, options) : TemplateCompiler</h4><p>Creates a compiler for a given template path and given options.</p>
<h4 id="compilesrc-path-options-callback"><a name="compilesrc-path-options-callback" class="anchor" href="#compilesrc-path-options-callback"><span class="header-link"></span></a>compile(src, path, options, callback)</h4><p>Compiles a template given the loaded template source, the file system path of the source template and options.
Currently, compilation is synchronous so the callback is optional. In the future, we may allow asynchronous
compilation.</p>
<p>The result will be the compiled JavaScript source code.</p>
<h4 id="compilefilepath-options-callback"><a name="compilefilepath-options-callback" class="anchor" href="#compilefilepath-options-callback"><span class="header-link"></span></a>compileFile(path, options, callback)</h4><p>Compiles a template given the loaded template source, the file system path of the source template and options.
Currently, compilation is synchronous so the callback is optional. In the future, we may allow asynchronous
compilation.</p>
<p>The result will be the compiled JavaScript source code.</p>
<h4 id="getlastmodifiedpath-options-callback"><a name="getlastmodifiedpath-options-callback" class="anchor" href="#getlastmodifiedpath-options-callback"><span class="header-link"></span></a>getLastModified(path, options, callback)</h4><p>Compiles a template given the loaded template source, the file system path of the source template and options.
Currently, this method is synchronous so the callback is optional. In the future, we may allow this method to be asynchronous.</p>
<p>Returns the last modified time as a number.</p>
<h4 id="clearcaches"><a name="clearcaches" class="anchor" href="#clearcaches"><span class="header-link"></span></a>clearCaches()</h4><p>Clears any internal caches used by the compiler. Needed for hot-reloading.</p>
<h3 id="properties-1"><a name="properties-1" class="anchor" href="#properties-1"><span class="header-link"></span></a>Properties</h3><h4 id="defaultoptions"><a name="defaultoptions" class="anchor" href="#defaultoptions"><span class="header-link"></span></a>defaultOptions</h4><p>The default options used by the compiler. These options can be changed as shown in the following sample code:</p>
<pre><code class="lang-javascript"><span class="hljs-built_in">require</span>(<span class="hljs-string">'marko/compiler'</span>).defaultOptions.writeToDisk = <span class="hljs-literal">false</span>;
</code></pre>
<p>Default options:</p>
<pre><code class="lang-javascript">{
    <span class="hljs-comment">/**
     * Set of tag names that should automatically have whitespace preserved.
     * Alternatively, if value is `true` then whitespace will be preserved
     * for all tags.
     */</span>
    preserveWhitespace: {
        <span class="hljs-string">'pre'</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-string">'textarea'</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-string">'script'</span>: <span class="hljs-literal">true</span>
    },
    <span class="hljs-comment">/**
     * Set of tag names that should be allowed to be rendered as a self-closing
     * XML tag. A self-closing tag will only be rendered if the tag has no nested
     * content. HTML doesn't allow self-closing tags so you should likely
     * never use this.
     */</span>
    allowSelfClosing: {},
    <span class="hljs-comment">/**
     * Set of tag names that should be rendered with a start tag only.
     */</span>
    startTagOnly: {
        <span class="hljs-string">'img'</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-string">'br'</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-string">'input'</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-string">'meta'</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-string">'link'</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-string">'hr'</span>: <span class="hljs-literal">true</span>
    },
    <span class="hljs-comment">/**
     * If true, then the compiler will check the disk to see if a previously compiled
     * template is the same age or newer than the source template. If so, the previously
     * compiled template will be loaded. Otherwise, the template will be recompiled
     * and saved to disk.
     *
     * If false, the template will always be recompiled. If `writeToDisk` is false
     * then this option will be ignored.
     */</span>
    checkUpToDate: <span class="hljs-literal">true</span>,
    <span class="hljs-comment">/**
     * If true (the default) then compiled templates will be written to disk. If false,
     * compiled templates will not be written to disk (i.e., no `.marko.js` file will
     * be generated)
     */</span>
    writeToDisk: <span class="hljs-literal">true</span>
}
</code></pre>
</main></div><footer id="footer"><section id="footer-message" class="container">© 2015 eBay, Inc</section></footer><script src="/static/docs-page-e9575dd1.js"></script>
<script src="/static/marko-widgets-3e971ca6.js"></script>
<script src="/static/marko-0d5e7b74.js"></script>
<script>$rmod.ready();</script><noscript id="markoWidgets" data-ids="header"></noscript><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66854919-1', 'markojs.com');
  ga('send', 'pageview');

</script><script>
          ((window.gitter = {}).chat = {}).options = {
            room: 'marko-js/marko'
          };
        </script><script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async defer></script></body></html>